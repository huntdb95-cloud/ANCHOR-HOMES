<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Subcontractors | Anchors Homes LLC</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">
        <img src="logo.png" alt="Anchors Homes LLC logo" class="brand-logo" />
        <span class="brand-text">
          <span class="brand-name">Anchors Homes LLC</span>
          <span class="brand-tagline">Custom Homes &amp; Remodeling</span>
        </span>
      </a>
      <button class="nav-toggle" aria-label="Toggle navigation">
        <span></span><span></span><span></span>
      </button>
      <nav class="main-nav">
        <a href="index.html">Home</a>
        <a href="projects.html">Projects</a>
        <a href="subcontractors.html">Subcontractors</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="page-header">
      <div class="container">
        <h1>Subcontractor Agreement &amp; W-9</h1>
        <p class="sub-page-intro">
          Use this page to submit your signed subcontractor agreement and W-9
          directly to Anchors Homes LLC. You can fill in the fields below, sign
          with your mouse or finger, and we’ll receive copies of the agreement
          and the W-9 form as image attachments via Formspree.
        </p>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <!-- Entire flow is one form -->
        <form
          id="sub-form"
          action="https://formspree.io/f/xdkqdpgd"
          method="POST"
          enctype="multipart/form-data"
        >
          <!-- Basic info (dark card) -->
          <div class="form-card">
            <h2 style="margin-top: 0; margin-bottom: 0.75rem;">Basic subcontractor information</h2>
            <div class="form-grid">
              <div>
                <label class="form-label" for="company-name">Company / Individual Name</label>
                <input class="form-input" type="text" id="company-name" name="company_name" required />
              </div>
              <div>
                <label class="form-label" for="trade">Primary Trade</label>
                <input class="form-input" type="text" id="trade" name="trade" placeholder="Framing, electrical, plumbing, etc." />
              </div>

              <div>
                <label class="form-label" for="contact-name">Contact Person</label>
                <input class="form-input" type="text" id="contact-name" name="contact_name" />
              </div>
              <div>
                <label class="form-label" for="contact-phone">Phone</label>
                <input class="form-input" type="tel" id="contact-phone" name="contact_phone" />
              </div>

              <div>
                <label class="form-label" for="contact-email">Email</label>
                <input class="form-input" type="email" id="contact-email" name="contact_email" required />
              </div>
              <div>
                <label class="form-label" for="work-area">Typical Work Area</label>
                <input class="form-input" type="text" id="work-area" name="work_area" placeholder="Cities / counties you serve" />
              </div>

              <div class="form-row-full">
                <label class="form-label" for="experience">
                  Brief Description of Experience
                </label>
                <textarea
                  id="experience"
                  name="experience"
                  class="form-textarea"
                  placeholder="Years in business, types of projects, builder references, etc."
                ></textarea>
              </div>
            </div>
          </div>

          <!-- Subcontractor Agreement (white card to capture) -->
          <div id="agreement-capture" class="document-card agreement-card">
            <h2 style="margin-top: 0;">Subcontractors Agreement</h2>

            <!-- (Agreement text exactly as you had it before; omitted comments for brevity) -->
            <p style="font-size: 0.9rem; line-height: 1.5;">
              This document is a binding contract, which will serve as a blanket agreement for and
              between <strong>Anchors Homes LLC</strong>, herein known as
              <strong>Builder</strong>, and the undersigned, referred to hereafter as
              <strong>Subcontractor</strong>. By signing, Subcontractor and Builder agree to the
              terms set forth herein. This agreement shall remain in force from the date hereof and
              from year to year, unless a change is agreed to in writing by both Builder and
              Subcontractor.
            </p>

            <!-- ... all Sections 1–16 exactly as we had them before ... -->

            <h3>1. General Performance</h3>
            <p style="font-size: 0.85rem; line-height: 1.6;">
              All work of the Subcontractor will be performed in a good and workmanlike manner in
              accordance with the plans and specifications for each job, and must comply with all
              Federal and State laws, codes, and regulations, and all county and/or municipal
              ordinances and regulations effective where the work is to be performed under this
              contract. All permits, fees, taxes, and expenses connected with such compliance are
              to be paid by the Subcontractor.
            </p>

            <!-- (keep the rest of the numbered sections exactly as in your current file) -->

            <h3>2. Independent Contractor</h3>
            <p style="font-size: 0.85rem; line-height: 1.6;">
              Subcontractor is being hired solely as an independent contractor, and neither the
              Subcontractor nor Subcontractor’s employees shall be deemed to be employees of the
              Builder.
            </p>

            <!-- ... sections 3 through 16 (unchanged) ... -->

            <h3>16. Warranty</h3>
            <p style="font-size: 0.85rem; line-height: 1.6;">
              Subcontractor shall warrant against defects in workmanship and materials supplied by
              Subcontractor for a period of one year from the date the home is first occupied by
              the homeowner. The warranty shall be of the same standards and duration as Builder’s
              warranty to the Owner.
            </p>

            <hr style="margin: 1.25rem 0;" />

            <p style="font-size: 0.9rem; line-height: 1.5;">
              By signing below, the parties acknowledge that they have read and agree to the terms
              of this Subcontractors Agreement.
            </p>

            <div style="display: grid; grid-template-columns: minmax(0, 1.2fr) minmax(0, 0.8fr); gap: 1rem; margin-top: 0.75rem;">
              <div>
                <label for="agreement-sub-name">Name of Subcontractor (print)</label>
                <input
                  type="text"
                  id="agreement-sub-name"
                  name="agreement_subcontractor_name"
                  required
                />

                <!-- SIGNATURE PAD INSTEAD OF TEXT INPUT -->
                <div class="signature-block">
                  <label for="agreement-signature-pad">Subcontractor Signature</label>
                  <div class="signature-pad-container">
                    <canvas
                      id="agreement-signature-pad"
                      class="signature-pad"
                    ></canvas>
                  </div>
                  <button
                    type="button"
                    class="btn-signature-clear"
                    data-target="agreement-signature-pad"
                  >
                    Clear signature
                  </button>
                </div>

                <label for="agreement-sub-title">Title</label>
                <input
                  type="text"
                  id="agreement-sub-title"
                  name="agreement_subcontractor_title"
                />

                <label for="agreement-sub-date">Date</label>
                <input
                  type="date"
                  id="agreement-sub-date"
                  name="agreement_subcontractor_date"
                  required
                />
              </div>

              <div>
                <p style="font-size: 0.85rem; margin-bottom: 0.35rem;">
                  <strong>Builder:</strong><br />
                  Austin Bream – Anchors Homes LLC
                </p>
                <p style="font-size: 0.8rem; color: #4b5563; margin-top: 0;">
                  Builder’s signature will be added by Anchors Homes LLC upon receipt.
                </p>

                <label for="agreement-initials">Subcontractor Initials</label>
                <input
                  type="text"
                  id="agreement-initials"
                  name="agreement_initials"
                  placeholder="Initial here to acknowledge all sections"
                />
              </div>
            </div>
          </div>

          <!-- W-9 overlay (white card to capture) -->
          <div class="document-card" style="margin-top: 2rem;">
            <h2 style="margin-top: 0;">W-9 – Request for Taxpayer Identification Number</h2>
            <p style="font-size: 0.85rem; margin-top: 0;">
              Type directly into the fields on the W-9 below, then sign on the line. We’ll capture
              an image of the completed form and submit it with your agreement.
            </p>

            <div id="w9-capture" class="w9-wrapper">
              <!-- Blank W-9 image -->
              <img src="images/w9-blank.jpg" alt="Blank IRS Form W-9" class="w9-bg" />

              <!-- Overlay fields -->
              <input
                type="text"
                name="w9_name"
                class="w9-input w9-name"
                placeholder="Name as shown on your tax return"
                required
              />
              <input
                type="text"
                name="w9_business"
                class="w9-input w9-business"
                placeholder="Business name / disregarded entity (optional)"
              />
                <!-- Entity type (federal tax classification) as checkboxes -->
  <div class="w9-tax-class-group">
    <label>
      <input type="checkbox" name="w9_tax_class_individual" />
      Individual / sole proprietor
    </label>
    <label>
      <input type="checkbox" name="w9_tax_class_c_corp" />
      C Corp
    </label>
    <label>
      <input type="checkbox" name="w9_tax_class_s_corp" />
      S Corp
    </label>
    <label>
      <input type="checkbox" name="w9_tax_class_partnership" />
      Partnership
    </label>
    <label>
      <input type="checkbox" name="w9_tax_class_trust" />
      Trust / estate
    </label>
    <label>
      <input type="checkbox" name="w9_tax_class_llc" />
      LLC
    </label>
    <label>
      <input type="checkbox" name="w9_tax_class_other" />
      Other
    </label>
  </div>

              <input
                type="text"
                name="w9_address"
                class="w9-input w9-address"
                placeholder="Address (number, street, and apt. or suite no.)"
                required
              />
              <input
                type="text"
                name="w9_city"
                class="w9-input w9-city"
                placeholder="City, state, and ZIP code"
                required
              />
              <input
                type="text"
                name="w9_account"
                class="w9-input w9-account"
                placeholder="List account number(s) here (optional)"
              />

              <!-- SSN segments -->
              <input
                type="text"
                name="w9_ssn_1"
                class="w9-input w9-ssn-1"
                maxlength="3"
                placeholder="XXX"
              />
              <input
                type="text"
                name="w9_ssn_2"
                class="w9-input w9-ssn-2"
                maxlength="2"
                placeholder="XX"
              />
              <input
                type="text"
                name="w9_ssn_3"
                class="w9-input w9-ssn-3"
                maxlength="4"
                placeholder="XXXX"
              />

              <!-- EIN -->
              <input
                type="text"
                name="w9_ein"
                class="w9-input w9-ein"
                placeholder="XX-XXXXXXX"
              />

              <!-- SIGNATURE PAD ON THE SIGN HERE LINE -->
              <div class="w9-signature-pad">
                <canvas id="w9-signature-pad" class="signature-pad"></canvas>
              </div>

              <!-- Date beside the signature -->
              <input
                type="text"
                name="w9_date"
                class="w9-input w9-date"
                placeholder="Date"
                required
              />
            </div>
          </div>

          <!-- Submit section -->
          <div style="margin-top: 1.75rem;">
            <button type="submit" class="btn primary">
              Generate documents &amp; submit to Anchors Homes
            </button>
            <div id="sub-status"></div>
          </div>
        </form>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container site-footer-inner">
      <span>&copy; <span id="year"></span> Anchors Homes LLC.</span>
      <span>Thank you for partnering with us.</span>
    </div>
  </footer>

  <script src="scripts.js"></script>

  <!-- html2canvas to capture Agreement + W-9 as images -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <!-- Signature Pad for drawing signatures -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    const form = document.getElementById("sub-form");
    const statusEl = document.getElementById("sub-status");

    // Initialize signature pads (black ink)
    const agreementSigCanvas = document.getElementById("agreement-signature-pad");
const w9SigCanvas = document.getElementById("w9-signature-pad");

function initSignatureCanvas(canvas) {
  if (!canvas) return;
  const ratio = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  canvas.width = rect.width * ratio;
  canvas.height = rect.height * ratio;
  const ctx = canvas.getContext("2d");
  ctx.scale(ratio, ratio);
}

// Initialize once on load — no resize listener (so scrolling won't clear)
initSignatureCanvas(agreementSigCanvas);
initSignatureCanvas(w9SigCanvas);

const agreementPad = new SignaturePad(agreementSigCanvas, {
  penColor: "#000000",
  backgroundColor: "rgba(0,0,0,0)"
});

const w9Pad = new SignaturePad(w9SigCanvas, {
  penColor: "#000000",
  backgroundColor: "rgba(0,0,0,0)"
});

    // Clear buttons
    document.querySelectorAll(".btn-signature-clear").forEach((btn) => {
      btn.addEventListener("click", () => {
        const targetId = btn.getAttribute("data-target");
        if (targetId === "agreement-signature-pad") {
          agreementPad.clear();
        }
      });
    });

    form.addEventListener("submit", async (event) => {
      event.preventDefault();
      statusEl.className = "";

      // Make sure both signatures exist
      if (agreementPad.isEmpty() || w9Pad.isEmpty()) {
        statusEl.className = "error";
        statusEl.textContent =
          "Please sign both the subcontractor agreement and the W-9 before submitting.";
        return;
      }

      statusEl.textContent = "Preparing documents… please wait.";

      try {
        const agreementEl = document.getElementById("agreement-capture");
        const w9El = document.getElementById("w9-capture");

        // Capture both sections as images (signatures included)
        const [agreementCanvas, w9Canvas] = await Promise.all([
          html2canvas(agreementEl, { scale: 2 }),
          html2canvas(w9El, { scale: 2 })
        ]);

        const agreementBlob = await new Promise((resolve) =>
          agreementCanvas.toBlob(resolve, "image/png")
        );
        const w9Blob = await new Promise((resolve) =>
          w9Canvas.toBlob(resolve, "image/png")
        );

        const formData = new FormData(form); // includes all text inputs

        if (agreementBlob) {
          formData.append("agreement_file", agreementBlob, "subcontractor-agreement.png");
        }
        if (w9Blob) {
          formData.append("w9_file", w9Blob, "w9-filled.png");
        }

        const response = await fetch(form.action, {
          method: "POST",
          body: formData,
          headers: { Accept: "application/json" }
        });

        if (response.ok) {
          form.reset();
          agreementPad.clear();
          w9Pad.clear();
          statusEl.className = "success";
          statusEl.textContent =
            "Thank you! Your subcontractor information, agreement, and W-9 have been submitted.";
        } else {
          statusEl.className = "error";
          statusEl.textContent =
            "There was a problem submitting the form. Please try again or contact us directly.";
        }
      } catch (err) {
        console.error(err);
        statusEl.className = "error";
        statusEl.textContent =
          "Unexpected error preparing the documents. Please refresh the page and try again.";
      }
    });
  </script>
</body>
</html>
