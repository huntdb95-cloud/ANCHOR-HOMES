<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Projects | Anchor Homes LLC</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- Page-specific layout tweaks (no need to touch styles.css) -->
  <style>
    /* Stack map + highlights vertically */
    .projects-layout {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }

    /* Make map fill more of the screen */
    #projects-map {
      width: 100%;
      height: 72vh;          /* big on desktop */
      min-height: 520px;     /* keeps it large on smaller screens */
      border-radius: 16px;
      overflow: hidden;
    }

    /* Highlights section now full width */
    .project-legend {
      width: 100%;
      border-radius: 16px;
    }

    /* Improve popup image + link behavior */
    .project-popup img {
      width: 100%;
      max-width: 260px;
      height: auto;
      display: block;
      border-radius: 12px;
      margin-top: 0.5rem;
    }

    .project-popup-image-link {
      display: inline-block;
      border-radius: 12px;
      overflow: hidden;
    }
    /* ===== Upgraded Leaflet popup styling (projects page only) ===== */
.leaflet-popup-content-wrapper {
  border-radius: 18px;
  padding: 0;
  overflow: hidden;
  background: rgba(18, 22, 30, 0.92);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.10);
  box-shadow: 0 18px 40px rgba(0,0,0,0.45);
}

.leaflet-popup-tip {
  background: rgba(18, 22, 30, 0.92);
  border: 1px solid rgba(255,255,255,0.10);
}

.leaflet-popup-content {
  margin: 0;
  width: 300px !important; /* consistent width */
  font-family: inherit;
}

.project-popup-card {
  display: flex;
  flex-direction: column;
}

.project-popup-media {
  position: relative;
  display: block;
  line-height: 0;
}

.project-popup-media img {
  width: 100%;
  height: 165px;
  object-fit: cover;
  display: block;
  transition: transform 160ms ease, filter 160ms ease;
}

.project-popup-media:hover img {
  transform: scale(1.03);
  filter: saturate(1.05);
}

.project-popup-overlay {
  position: absolute;
  inset: auto 12px 12px 12px;
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.project-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 999px;
  font-size: 12px;
  line-height: 1;
  color: rgba(255,255,255,0.92);
  background: rgba(0,0,0,0.45);
  border: 1px solid rgba(255,255,255,0.16);
}

.project-popup-body {
  padding: 12px 14px 14px 14px;
}

.project-popup-title {
  margin: 2px 0 6px 0;
  font-size: 16px;
  line-height: 1.25;
  font-weight: 700;
  color: rgba(255,255,255,0.96);
}

.project-popup-scope {
  margin: 0 0 12px 0;
  font-size: 13px;
  line-height: 1.35;
  color: rgba(255,255,255,0.78);
}

.project-popup-actions {
  display: flex;
  gap: 10px;
  align-items: center;
}

.project-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 9px 12px;
  border-radius: 12px;
  font-weight: 700;
  font-size: 13px;
  text-decoration: none;
  border: 1px solid rgba(255,255,255,0.16);
  background: rgba(255,255,255,0.08);
  color: rgba(255,255,255,0.95);
  transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
  white-space: nowrap;
}

.project-btn:hover {
  transform: translateY(-1px);
  background: rgba(255,255,255,0.12);
  border-color: rgba(255,255,255,0.22);
}

.project-link {
  font-size: 13px;
  color: rgba(255,255,255,0.80);
  text-decoration: underline;
  text-underline-offset: 3px;
}

.project-link:hover {
  color: rgba(255,255,255,0.95);
}

/* Mobile: allow narrower popups */
@media (max-width: 420px) {
  .leaflet-popup-content { width: 260px !important; }
  .project-popup-media img { height: 150px; }
}


    @media (max-width: 768px) {
      #projects-map {
        height: 64vh;
        min-height: 420px;
      }
    }
  </style>
</head>

<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">
        <img src="logo.png" alt="Anchor Homes LLC logo" class="brand-logo" />
        <span class="brand-text">
          <span class="brand-name">Anchor Homes LLC</span>
          <span class="brand-tagline">Custom Homes &amp; Remodeling</span>
        </span>
      </a>

      <button class="nav-toggle" aria-label="Toggle navigation">
        <span></span><span></span><span></span>
      </button>

      <nav class="main-nav">
        <a href="index.html">Home</a>
        <a href="projects.html">Projects</a>
        <a href="subcontractors.html">Subcontractors</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
        <a href="anchor.html">Anchor</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="page-header">
      <div class="container">
        <h1>Current &amp; Recent Projects</h1>
        <p>
          Explore some of the locations where Anchor Homes LLC is actively
          building and renovating. Tap on a pin to see a snapshot of the project.
        </p>
      </div>
    </section>

    <section class="section">
      <div class="container projects-layout">
        <!-- MAP FIRST (bigger) -->
        <div id="projects-map"></div>

        <!-- HIGHLIGHTS BELOW MAP -->
        <aside class="project-legend">
          <h2>Project Highlights</h2>
          <ul id="project-list">
            <!-- Project list is populated via JavaScript -->
          </ul>

          <p style="margin-top: 0.75rem; color: var(--color-text-muted); font-size: 0.85rem;">
            <strong>Tip:</strong> Click a map pin to view details. The photo in the popup is clickable
            and opens the project‚Äôs gallery page.
          </p>
        </aside>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container site-footer-inner">
      <span>&copy; <span id="year"></span> Anchor Homes LLC.</span>
      <span>Projects shown for illustration. Ask about our latest builds.</span>
    </div>
  </footer>

  <script src="scripts.js"></script>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // Projects (update these anytime)
    const projects = [
      {
        name: "Old Hickory Lake Renovation",
        location: "Old Hickory, TN",
        lat: 36.2558,
        lng: -86.6420,
        image: "images/project-old-hickory.jpg",
        scope: "Lakeside renovation and exterior updates",
        galleryPage: "project-old-hickory-gallery.html"
      },
      {
        name: "Nolensville New Build",
        location: "Nolensville, TN",
        lat: 35.9568,
        lng: -86.6669,
        image: "images/project-nolensville.jpg",
        scope: "Ground-up custom home",
        galleryPage: "project-nolensville-gallery.html"
      },
      {
        name: "Sylvan Park Remodel",
        location: "Sylvan Park, Nashville, TN",
        lat: 36.1436,
        lng: -86.8390,
        image: "images/project-sylvan-park.jpg",
        scope: "Interior remodel in historic neighborhood",
        galleryPage: "project-sylvan-park-gallery.html"
      },
      {
        name: "Franklin Farmhouse",
        location: "Franklin, TN",
        lat: 35.9251,
        lng: -86.8689,
        image: "images/project-franklin.jpg",
        scope: "Modern farmhouse with classic details",
        galleryPage: "project-franklin-gallery.html"
      },
      {
        name: "Arrington Estate Home",
        location: "Arrington, TN",
        lat: 35.8681,
        lng: -86.7083,
        image: "images/project-arrington.jpg",
        scope: "Estate-style custom home",
        galleryPage: "project-arrington-gallery.html"
      }
    ];

    const map = L.map("projects-map");

    // Center over Middle Tennessee (fallback)
    const defaultCenter = [36.0, -86.8];
    map.setView(defaultCenter, 9);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 18,
      attribution: "&copy; OpenStreetMap contributors"
    }).addTo(map);

    const bounds = [];
    const markersByIndex = [];

    projects.forEach((project, index) => {
      const { lat, lng } = project;

      const popupContent = `
  <div class="project-popup-card">
    <a class="project-popup-media" href="${project.galleryPage}" aria-label="View gallery for ${project.name}">
      <img src="${project.image}" alt="${project.name}" />
      <div class="project-popup-overlay">
        <span class="project-chip">üìç ${project.location}</span>
        <span class="project-chip">üñºÔ∏è Gallery</span>
      </div>
    </a>

    <div class="project-popup-body">
      <div class="project-popup-title">${project.name}</div>
      <p class="project-popup-scope">${project.scope}</p>

      <div class="project-popup-actions">
        <a class="project-btn" href="${project.galleryPage}">View Gallery ‚Üí</a>
        <a class="project-link" href="${project.galleryPage}">Open</a>
      </div>
    </div>
  </div>
`;


      const marker = L.marker([lat, lng]).addTo(map).bindPopup(popupContent);
      markersByIndex[index] = marker;
      bounds.push([lat, lng]);
    });

    if (bounds.length > 0) {
      map.fitBounds(bounds, { padding: [30, 30] });
    }

    // Populate list BELOW map
    const listEl = document.getElementById("project-list");
    projects.forEach((project, index) => {
      const li = document.createElement("li");
      li.innerHTML = `
        <span class="project-name">${project.name}</span><br />
        <span>${project.location}</span><br />
        <span style="font-size: 0.85rem; color: var(--color-text-muted);">${project.scope}</span>
      `;
      li.style.cursor = "pointer";
      li.addEventListener("click", () => {
        map.setView([project.lat, project.lng], 13, { animate: true });
        const marker = markersByIndex[index];
        if (marker) marker.openPopup();
      });
      listEl.appendChild(li);
    });
  </script>
</body>
</html>
